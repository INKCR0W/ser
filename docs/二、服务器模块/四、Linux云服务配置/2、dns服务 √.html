<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-二、服务器模块/四、Linux云服务配置/2、dns服务 √" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">2、dns服务 √ | ser</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ser.crow.pub/docs/二、服务器模块/四、Linux云服务配置/2、dns服务 √"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2、dns服务 √ | ser"><meta data-rh="true" name="description" content="题目："><meta data-rh="true" property="og:description" content="题目："><link data-rh="true" rel="icon" href="/img/logo.png"><link data-rh="true" rel="canonical" href="https://ser.crow.pub/docs/二、服务器模块/四、Linux云服务配置/2、dns服务 √"><link data-rh="true" rel="alternate" href="https://ser.crow.pub/docs/二、服务器模块/四、Linux云服务配置/2、dns服务 √" hreflang="en"><link data-rh="true" rel="alternate" href="https://ser.crow.pub/docs/二、服务器模块/四、Linux云服务配置/2、dns服务 √" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.80068ed9.css">
<script src="/assets/js/runtime~main.71b79737.js" defer="defer"></script>
<script src="/assets/js/main.35104207.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Pluto Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="Pluto Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">NOTHING</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/开班">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/jASXBzdcnT" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/INKCR0W/ser" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/网络模块">网络模块</a><button aria-label="Expand sidebar category &#x27;网络模块&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/开班">开班</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/服务器模块">服务器模块</a><button aria-label="Collapse sidebar category &#x27;服务器模块&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/一、X86架构计算机安装与管理">一、X86架构计算机安装与管理</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/windows云服务配置">Windows云服务配置</a><button aria-label="Expand sidebar category &#x27;Windows云服务配置&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/二、ARM64架构计算机操作系统安装与管理">二、ARM64架构计算机操作系统安装与管理</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/linux云服务配置">Linux云服务配置</a><button aria-label="Collapse sidebar category &#x27;Linux云服务配置&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/1、系统安装 √">1、系统安装 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/2、dns服务 √">2、dns服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/3、ansible服务 √">3、ansible服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/4、Apache服务 √">4、Apache服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/5、nginx和tomcat服务 √">5、nginx和tomcat服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/6、Samba服务 √">6、Samba服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/7、nfs服务 √">7、nfs服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/8、kubernetes服务-arm √">8、kubernetes服务-arm √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/9、iscsi服务 √">9、iscsi服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/10、mariadb服务 √">10、mariadb服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/11、mysql服务 √">11、mysql服务 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/12、podman服务x86 √">12、podman服务x86 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/13、podman服务-arm √">13、podman服务-arm √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/14、磁盘配额 √">14、磁盘配额 √</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/二、服务器模块/四、Linux云服务配置/15、ftp服务 √">15、ftp服务 √</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/网络运维">网络运维</a><button aria-label="Expand sidebar category &#x27;网络运维&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/答案提交">答案提交</a><button aria-label="Expand sidebar category &#x27;答案提交&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/排错思路">排错思路</a><button aria-label="Expand sidebar category &#x27;排错思路&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>2、dns服务 √</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="题目"><strong>题目：</strong><a href="#题目" class="hash-link" aria-label="Direct link to 题目" title="Direct link to 题目">​</a></h2>
<p>创建 DNS 服务器，实现企业域名访问。
1、配置 linux 主机的 IP 地址和主机名称。
2、所有 linux 主机启用防火墙（kubernetes 服务主机除外），防火墙区域为 public，在防火墙中放行对应服务端口。
3、所有 linux 主机之间（包含本主机）root 用户实现密钥 ssh 认证，禁用密码认证。
4、利用 chrony，配置 linux1 为其他 linux 主机提供 NTP 服务。
5、利用 bind，配置 linux1 为主 DNS 服务器，linux2 为备用 DNS 服务器，为所有 linux 主机提供冗余 DNS 正反向解析服务。正向区域文件均/var/named/named.skills ， 反 向 区 域 文 件 均 为 /var/named/named.10。
6、配置 linux1 为 CA 服务器,为 linux 主机颁发证书。证书颁发机构有效期 10 年，公用名为 linux1.skills.lan。申请并颁发一张供 linux 服务器使用的证书，证书信息：有效期=5 年，公用名=skills.lan，国家=CN，省=Beijing，城市=Beijing，组织=skills，组织单位=system， 使用者可选名称=*.skills.lan 和 skills.lan。将证书skills.crt 和私钥 skills.key 复制到需要证书的 linux 服务器/etc/pki/tls 目 录。浏览器访问 https 网站时，不出现证书警告信息。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置步骤">配置步骤：<a href="#配置步骤" class="hash-link" aria-label="Direct link to 配置步骤：" title="Direct link to 配置步骤：">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1小题">1小题<a href="#1小题" class="hash-link" aria-label="Direct link to 1小题" title="Direct link to 1小题">​</a></h3>
<p>修改IP地址vi /etc/NetworkManager/system-connections/ens160.nmconnection #使用vi编辑器修改网卡配置文件</p>
<p>[ipv4]
method=manual  				      #取消自动获取，改为manual，manual为手动的意思
address1=10.4.220.100/24,10.4.220.1  #配置IP地址和网关
dns=10.4.220.101;10.4.220.102  	      #dns配置
nmcli connection reload  ens160 加载配置信息
nmcli connection up ens160 激活配置
修改主机名nmcli g hostname linux1</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2小题">2小题<a href="#2小题" class="hash-link" aria-label="Direct link to 2小题" title="Direct link to 2小题">​</a></h3>
<p>放行端口firewall-cmd --zone=public --add-port=22/tcp --add-port=53/tcp --add-port=53/udp --add-port=123/udp --add-port=80/tcp --add-port=443/tcp --add-port=21/tcp --add-port=8080/tcp --add-port=2049/tcp --add-port=111/tcp --add-port=111/udp --add-port=139/tcp --add-port=445/tcp --add-port=860/tcp --add-port=3260/tcp --add-port=3306/tcp --add-port=8000/tcp --permanent</p>
<p>firewall-cmd --reload   #重启防火墙
firewall-cmd --list-all #查看放行情况
服务端口说明dns：53/tcp 53/udp
chrony端口：123/UDP
ansible：22/tcp
Apache2服务：80/TCP 443
ftp端口：21/TCP  VSFTP
tomcat端口：80/TCP 443/TCP 8080/TCP
nfs端口：2049/TCP 111/TCP  111/UDP
smaba端口：139/TCP 445/TCP
iscsi端口：860/TCP 3260/tcp
mariadb：3306/tcp
podman：8000/udp</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3小题">3小题<a href="#3小题" class="hash-link" aria-label="Direct link to 3小题" title="Direct link to 3小题">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4小题">4小题<a href="#4小题" class="hash-link" aria-label="Direct link to 4小题" title="Direct link to 4小  题">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1713862969706-54673393-ec0f-4649-83a9-91d8e09aaa6b.png#averageHue=%23340f29&amp;clientId=u1ccbc5f7-73d6-4&amp;from=paste&amp;height=88&amp;id=u4da884be&amp;originHeight=99&amp;originWidth=971&amp;originalType=binary&amp;ratio=1.125&amp;rotation=0&amp;showTitle=false&amp;size=41662&amp;status=done&amp;style=none&amp;taskId=u570d0db3-dce8-4777-ae42-20050dfe32a&amp;title=&amp;width=863.1111111111111" alt="image.png" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5小题">5小题<a href="#5小题" class="hash-link" aria-label="Direct link to 5小题" title="Direct link to 5小题">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="linux1执行">Linux1执行<a href="#linux1执行" class="hash-link" aria-label="Direct link to Linux1执行" title="Direct link to Linux1执行">​</a></h4>
<p>yum install bind bind-utils   #安装dns服务
vi /etc/named.conf 	#编辑主配置文件
<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694768644277-b8dc003e-926e-44c2-9a4d-e61ea7537dcd.png#averageHue=%23300a25&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=224&amp;id=uadcf115d&amp;originHeight=308&amp;originWidth=987&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=57795&amp;status=done&amp;style=none&amp;taskId=ud42b02b5-b7c3-4754-9731-74931c9771e&amp;title=&amp;width=717.8181818181819" alt="image.png" class="img_ev3q">
vi /etc/named.rfc1912.zones #编辑区域文件
<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694768554468-adcb66c4-a60f-40e3-a246-ff5278c96a6e.png#averageHue=%23300a24&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=237&amp;id=u9d22180f&amp;originHeight=326&amp;originWidth=518&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=35361&amp;status=done&amp;style=none&amp;taskId=u3b86f3d1-5f26-4d2a-abf9-d7bb6e49808&amp;title=&amp;width=376.72727272727275" alt="image.png" class="img_ev3q">
cd /var/named/  #切换到配置文件目录
cp -p named.localhost named.skills #复制正向区域模板文件到新文件
cp -p named.loopback named.10	#复制反向区域模板到新文件
vi named.skills #编辑新的正向区域文件
<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694768770130-49c9b868-563c-4359-8b30-50c5619d2ed4.png#averageHue=%23300a24&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=316&amp;id=ue50060bc&amp;originHeight=434&amp;originWidth=838&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=48717&amp;status=done&amp;style=none&amp;taskId=u5d9bd0fa-b94a-4eae-aa66-bcbfa92eb3b&amp;title=&amp;width=609.4545454545455" alt="image.png" class="img_ev3q">
vi named.10 编辑新的反向区域文件
<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694768796922-f3abc66a-3d3a-4419-a77b-59ff5ded0cdc.png#averageHue=%23300a24&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=337&amp;id=u82999d7e&amp;originHeight=464&amp;originWidth=812&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=55393&amp;status=done&amp;style=none&amp;taskId=ub7a8e171-37db-4958-8774-a2d85d773da&amp;title=&amp;width=590.5454545454545" alt="image.png" class="img_ev3q">
systemc	restart named  #重启dns服务
测试正向解析<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694768911842-b24cfb9c-a0d2-49d0-8dd2-45daddc87dbb.png#averageHue=%23300a25&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=239&amp;id=LuMEG&amp;originHeight=329&amp;originWidth=1128&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=63040&amp;status=done&amp;style=none&amp;taskId=ue1bc3287-d8eb-49e9-801d-54868c02c74&amp;title=&amp;width=820.3636363636364" alt="image.png" class="img_ev3q">
测试反向解析<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694769008189-797f400c-6572-477d-b700-d87490c844ac.png#averageHue=%23300a24&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=608&amp;id=u775a0d5e&amp;originHeight=836&amp;originWidth=1310&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=112998&amp;status=done&amp;style=none&amp;taskId=u301fa0ef-d101-4896-99da-3257e25e9af&amp;title=&amp;width=952.7272727272727" alt="image.png" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="linux2执行">Linux2执行<a href="#linux2执行" class="hash-link" aria-label="Direct link to Linux2执行" title="Direct link to Linux2执行">​</a></h4>
<p>yum install bind bind-utils   #安装dns服务
vi /etc/named.conf 	#编辑主配置文件
<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694769352579-49051a10-e119-4c52-a038-f4aacb240a43.png#averageHue=%23300a25&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=215&amp;id=ud16ac350&amp;originHeight=296&amp;originWidth=1178&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=58245&amp;status=done&amp;style=none&amp;taskId=ue5c8f0c4-82a1-4ef8-b1af-485b1402233&amp;title=&amp;width=856.7272727272727" alt="image.png" class="img_ev3q">
vi /etc/named.rfc1912.zones #编辑区域文件
<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1713330978138-9ba7ddeb-2647-4063-8ce8-b47e244467ce.png#averageHue=%230a0806&amp;clientId=uac37162c-3352-4&amp;from=paste&amp;height=272&amp;id=u1c569668&amp;originHeight=306&amp;originWidth=761&amp;originalType=binary&amp;ratio=1.125&amp;rotation=0&amp;showTitle=false&amp;size=19694&amp;status=done&amp;style=none&amp;taskId=uaedbe2be-6f9b-4f47-85b8-33f649aa6e8&amp;title=&amp;width=676.4444444444445" alt="image.png" class="img_ev3q">systemctl restart named  #重启dns服务
systemctl stop named #关闭linux1的dns服务
测试辅助dns服务器的dns解析
正向测试
<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694769541094-63e1510b-e589-4281-84f8-49709287d0e0.png#averageHue=%23300a24&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=273&amp;id=u4984d80f&amp;originHeight=376&amp;originWidth=1304&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=64286&amp;status=done&amp;style=none&amp;taskId=u34fb00d9-08ed-4e39-8e16-2d0d747f25e&amp;title=&amp;width=948.3636363636364" alt="image.png" class="img_ev3q">
反向测试
<img decoding="async" loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/33622884/1694769584296-9dd16d7c-48bd-464a-bf6f-a7f531a3f5c2.png#averageHue=%23300a24&amp;clientId=u6d4a5990-51b7-4&amp;from=paste&amp;height=572&amp;id=ude4033bc&amp;originHeight=787&amp;originWidth=1299&amp;originalType=binary&amp;ratio=1.375&amp;rotation=0&amp;showTitle=false&amp;size=102697&amp;status=done&amp;style=none&amp;taskId=u27839020-3462-4744-927f-deb756d50a0&amp;title=&amp;width=944.7272727272727" alt="image.png" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="结论">结论<a href="#结论" class="hash-link" aria-label="Direct link to 结论" title="Direct link to 结论">​</a></h4>
<p>主dns服务器关闭的情况下，备用dns服务能正常解析</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6小题">6小题<a href="#6小题" class="hash-link" aria-label="Direct link to 6小题" title="Direct link to 6小题">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="方案一">方案一<a href="#方案一" class="hash-link" aria-label="Direct link to 方案一" title="Direct link to 方案一">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="步骤一根ca证书配置">步骤一、根CA证书配置<a href="#步骤一根ca证书配置" class="hash-link" aria-label="Direct link to 步骤一、根CA证书配置" title="Direct link to 步骤一、根CA证书配置">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">yum install  openssl-perl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd /etc/pki/CA/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">touch serial</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo 00 &gt;&gt; serial</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">touch index.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl genrsa -out cacert.key 2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl req -new -out ca.csr -key cacert.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl x509 -req -days 3650 -in ca.csr -signkey cacert.key -out cacert.crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="阶段二ssl证书配置">阶段二、SSL证书配置<a href="#阶段二ssl证书配置" class="hash-link" aria-label="Direct link to 阶段二、SSL证书配置" title="Direct link to 阶段二、SSL证书配置">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">req_extensions = v3_req  取消注释这一行 167行</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># extendedKeyUsage = critical,timeStamping</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[ v3_req ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subjectAltName = @alt_names 在v3字段下添加这一行</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Extensions to add to a certificate request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">basicConstraints = CA:TRUE   改为TRUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">keyUsage = nonRepudiation, digitalSignature, keyEncipherment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[alt_names]      添加字段</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DNS.1=skills.com  添加行</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DNS.2=*.skills.com 添加行</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl genrsa -out skills.key 2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl req -new -key skills.key -out skills.csr -config /etc/pki/tls/openssl.cnf -extensions v3_req</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl ca -in skills.csr -out skills.crt -cert cacert.crt  -keyfile cacert.key -extensions v3_req -days 1825 -config /etc/pki/tls/openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="阶段三ca证书转换">阶段三、CA证书转换<a href="#阶段三ca证书转换" class="hash-link" aria-label="Direct link to 阶段三、CA证书转换" title="Direct link to 阶段三、CA证书转换">​</a></h5>
<p>openssl pkcs12 -export -out cacert.pfx -inkey cacert.key -in cacert.crt
openssl pkcs12 -in cacert.pfx -nodes -out cacert.pem</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="阶段四配置信任">阶段四、配置信任<a href="#阶段四配置信任" class="hash-link" aria-label="Direct link to 阶段四、配置信任" title="Direct link to 阶段四、配置信任">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">for i in {1..9};do scp skills.* cacert.pem 10.4.220.10$i:/etc/pki/tls/ ;done</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat cacert.pem &gt;&gt; /etc/pki/tls/certs/ca-bundle.crt   #每一台有证书的主机执行</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="方案二">方案二<a href="#方案二" class="hash-link" aria-label="Direct link to 方案二" title="Direct link to 方案二">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="步骤一根ca证书配置-1">步骤一、根CA证书配置<a href="#步骤一根ca证书配置-1" class="hash-link" aria-label="Direct link to 步骤一、根CA证书配置" title="Direct link to 步骤一、根CA证书配置">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">yum install  openssl-perl -y</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd /etc/pki/CA/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">touch serial</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo 00 &gt;&gt; serial</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">touch index.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl genrsa -out cakey.pem 2048</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cp cakey.pem /etc/pki/CA/private/		#签发客户证书需要把ca私钥放到这个位置</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl req -new -x509 -key cakey.pem -days 3650 -out cacert.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="阶段二ssl证书配置-1">阶段二、SSL证书配置<a href="#阶段二ssl证书配置-1" class="hash-link" aria-label="Direct link to 阶段二、SSL证书配置" title="Direct link to 阶段二、SSL证书配置">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vim file.ext</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subjectAltName = @alt_names</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[alt_names]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DNS.1=skills.lan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DNS.2=*.skills.lan</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl genrsa -out skills.key 2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl req -new -key skills.key -out skills.csr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl ca -in skills.csr -out skills.crt -days 1825 -extfile file.ext</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="阶段三配置信任"><strong>阶段三、配置信任</strong><a href="#阶段三配置信任" class="hash-link" aria-label="Direct link to 阶段三配置信任" title="Direct link to 阶段三配置信任">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282923"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282923"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">for i in {1..9};do scp skills.* cacert.pem 10.4.220.10$i:/etc/pki/tls/ ;done</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat cacert.pem &gt;&gt; /etc/pki/tls/certs/ca-bundle.crt   #每一台有证书的主机执行</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">扩展key和crt 转为pfx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl pkcs12 -export -out skills.pfx -inkey skills.key -in skills.crt </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pfx转为pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl pkcs12 -in skills.pfx -nodes -out skills.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">从pem证书提取crt和key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl x509 -in skills.pem -out apache.crt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl rsa -in skills.pem -out apache.key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">转jks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">yum install javapackages-tools.noarch -y</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">keytool -importkeystore -srckeystore skills.pfx -destkeystore skills.jks -deststoretype JKS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/二、服务器模块/四、Linux云服务配置/1、系统安装 √"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">1、系统安装 √</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/二、服务器模块/四、Linux云服务配置/3、ansible服务 √"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3、ansible服务 √</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#题目" class="table-of-contents__link toc-highlight"><strong>题目：</strong></a></li><li><a href="#配置步骤" class="table-of-contents__link toc-highlight">配置步骤：</a><ul><li><a href="#1小题" class="table-of-contents__link toc-highlight">1小题</a></li><li><a href="#2小题" class="table-of-contents__link toc-highlight">2小题</a></li><li><a href="#3小题" class="table-of-contents__link toc-highlight">3小题</a></li><li><a href="#4小题" class="table-of-contents__link toc-highlight">4小题</a></li><li><a href="#5小题" class="table-of-contents__link toc-highlight">5小题</a></li><li><a href="#6小题" class="table-of-contents__link toc-highlight">6小题</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 NOTHING. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>