# 1、系统安装 √

## **<font style="color:rgb(0,0,0);">题目：</font>**
<font style="color:rgb(0,0,0);">1、PC1 web 连接 server2，给 server2 安装 rocky-arm64 CLI 系统（语 </font>

<font style="color:rgb(0,0,0);">言为英文）。 </font>

<font style="color:rgb(0,0,0);">2、配置 server2 的 IPv4 地址为 10.4.220.100/24。 </font>

<font style="color:rgb(0,0,0);">3、安装 qemu-kvm、libvirt 和 virt-install。 </font>

<font style="color:rgb(0,0,0);">4、创建 rocky-arm64 虚拟机，虚拟机磁盘文件保存在默认目录，名称为 </font>

<font style="color:rgb(0,0,0);">linuxN.qcow2(N 表示虚拟机编号 0-9，如虚拟机 linux1 的磁盘文件 </font>

<font style="color:rgb(0,0,0);">为 linux1.qcow2),虚拟机信息如下： </font>

![1694490920405-371f8edd-6f7b-4a4a-a799-eb9d105cad81.png](./img/KCff5bIPaRPhluha/1694490920405-371f8edd-6f7b-4a4a-a799-eb9d105cad81-629561.png)

![1694490934456-df3891ea-c2f5-4196-b85a-7ae782818d28.png](./img/KCff5bIPaRPhluha/1694490934456-df3891ea-c2f5-4196-b85a-7ae782818d28-924375.png)

<font style="color:rgb(0,0,0);">4.1 安装 linux0，系统为 rocky9 CLI，网络模式为桥接模式，用户 root </font>

<font style="color:rgb(0,0,0);">密码为 Key-1122。 </font>

<font style="color:rgb(0,0,0);">4.2 关闭 linux0，给 linux0 创建快照，快照名称为 linux-snapshot。 </font>

<font style="color:rgb(0,0,0);">根据 linux0 克隆虚拟机 linux1-linux9。</font>

## <font style="color:rgb(0,0,0);">配置步骤：</font>
## 1小题
<details class="lake-collapse"><summary id="u27a274d4"><span class="ne-text">1.1 修改Ubuntu IP地址与鲲泰服务器管理口同网段</span></summary><p id="u371b0189" class="ne-p"><span class="ne-text"></span></p></details>
<details class="lake-collapse"><summary id="ua35a7803"><span class="ne-text" style="font-size: 19px">1.2 web登录管理后台</span></summary><p id="u531960eb" class="ne-p"><span class="ne-text" style="font-size: 19px">鲲泰服务器管理口为192.168.2.10</span></p><p id="u4cc01d24" class="ne-p"><span class="ne-text" style="font-size: 19px">用户名：Admin 密码：Admin@123</span></p></details>
<details class="lake-collapse"><summary id="uca938c58"><span class="ne-text" style="font-size: 19px">1.3 创建逻辑盘（非必须）</span></summary><p id="u827dad51" class="ne-p"><span class="ne-text" style="font-size: 19px">服务器可能存在两块较小的磁盘，例如一块只有480G，需要进行合并成逻辑盘，不然可能不够完成9台甚至更多的虚拟机安装</span></p></details>
<details class="lake-collapse"><summary id="u80388dfc"><span class="ne-text" style="font-size: 19px">1.4  启动虚拟控制台</span></summary><p id="uf08e0c9f" class="ne-p"><span class="ne-text" style="font-size: 19px">位于首页右下角---选择html5共享模式</span></p></details>
<details class="lake-collapse"><summary id="u1e9f4a8c"><span class="ne-text" style="font-size: 19px">1.5 连接安装镜像</span></summary><p id="ubd047024" class="ne-p"><span class="ne-text" style="font-size: 19px">点击光盘图标--连接位于本地的镜像文件</span></p></details>
<details class="lake-collapse"><summary id="u0fded37c"><span class="ne-text" style="font-size: 19px">1.6 选择光驱启动</span></summary><p id="u99492938" class="ne-p"><span class="ne-text" style="font-size: 19px">点击B图标--选择光驱</span></p></details>
<details class="lake-collapse"><summary id="ub67cd1e0"><span class="ne-text" style="font-size: 19px">1.7 强制重启鲲泰</span></summary><p id="u0497d69a" class="ne-p"><span class="ne-text" style="font-size: 19px">点击电源图标--选择强制重启</span></p></details>
<details class="lake-collapse"><summary id="uca858a57"><span class="ne-text" style="font-size: 19px">1.8 选择安装rocky</span></summary><p id="uf6cb5a7a" class="ne-p"><span class="ne-text" style="font-size: 19px">需要关注安装界面的变化，跳出提示就快速选择安装rocky，不然它自动选择检查再安装会浪费很多时间</span></p></details>
<details class="lake-collapse"><summary id="udf6ded91"><span class="ne-text" style="font-size: 19px">1.9 进行磁盘分区</span></summary><p id="u7a1a8eb6" class="ne-p"><span class="ne-text" style="font-size: 19px">注意：题目中有明确要求分区容量就按题目来配置，没有要求的话boot分区1G即可，swap分区10G即可，home分区20G即可，其余空间都给/根分区。</span></p></details>
<details class="lake-collapse"><summary id="ua62b6635"><span class="ne-text" style="font-size: 19px">1.10 选择安装版本</span></summary><p id="u256d59be" class="ne-p"><span class="ne-text" style="font-size: 19px">选择最小化安装版本</span></p></details>
<details class="lake-collapse"><summary id="u4fd44682"><span class="ne-text" style="font-size: 19px">1.11 配置密码</span></summary><p id="uc4ecf689" class="ne-p"><span class="ne-text" style="font-size: 19px">按题目要求配置</span></p></details>
<details class="lake-collapse"><summary id="u5324388e"><span class="ne-text" style="font-size: 19px">1.12 进行安装</span></summary><p id="u0acb9f79" class="ne-p"><span class="ne-text" style="font-size: 19px">所有设置完成后，进行安装。</span></p></details>
## 2小题
<details class="lake-collapse"><summary id="u259e5f8d"><span class="ne-text" style="font-size: 19px">2.1 创建桥接网卡</span></summary><p id="u09b0e352" class="ne-p"><span class="ne-text" style="font-size: 16px">nmcli c add type bridge ifname br0 #创建桥设备 br0</span></p><p id="ue4ea8f4e" class="ne-p"><span class="ne-text" style="font-size: 16px">nmcli c add type bridge-slave ifname enp125s0f0 master br0 #配置桥设备桥接的网卡</span></p><p id="ufa129412" class="ne-p"><span class="ne-text" style="font-size: 16px">nmcli c show #查看连接情况</span></p></details>
<details class="lake-collapse"><summary id="u5042095e"><span class="ne-text" style="font-size: 19px">2.2 修改本地网卡为自动获取</span></summary><p id="u5c375e32" class="ne-p"><span class="ne-text" style="font-size: 16px">vi /etc/NetworkManager/system-connections/enp125s0f0.nmconnection</span></p><p id="u2519f872" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1710911651823-e9cded61-2456-4463-8706-59b2cc40d5f1.png" width="739.1666372948234" id="ag8yd" class="ne-image"></p></details>
<details class="lake-collapse"><summary id="uc672a325"><span class="ne-text" style="font-size: 19px">2.3 修改桥设备的IP地址为静态</span></summary><p id="ub2e72734" class="ne-p"><span class="ne-text" style="font-size: 16px">vi /etc/NetworkManager/system-connections/bridge-br0.nmconnection</span></p><p id="u822dedd7" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1710911680754-6ba08193-cc69-4490-811b-f27c5666d7ac.png" width="672.499973277252" id="T6vjC" class="ne-image"></p></details>
<details class="lake-collapse"><summary id="u665745db"><span class="ne-text" style="font-size: 19px">2.4 重启网卡</span></summary><p id="u9b57fa31" class="ne-p"><span class="ne-text">nmcli connection reload </span><span class="ne-text" style="font-size: 16px">enp125s0f0  #</span><span class="ne-text">加载配置信息，立即生效</span></p><p id="uf01581ac" class="ne-p"><span class="ne-text">nmcli connection up </span><span class="ne-text" style="font-size: 16px">enp125s0f0</span><span class="ne-text">         #激活配置</span></p></details>
<details class="lake-collapse"><summary id="u395fb0ac"><span class="ne-text" style="font-size: 19px">2.5 nmcli 查看网络连接情况</span></summary><p id="u397a8df6" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1710911811038-559f019e-c9a0-478b-a258-5a0b5faf16dd.png" width="732.4999708930663" id="y1d2w" class="ne-image"></p><p id="u2d734dca" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1713178227265-2521bcf3-3d3d-4943-bdd7-6087ed65a5e3.png" width="1021.8666666666667" id="ud5c19272" class="ne-image"></p></details>
<details class="lake-collapse"><summary id="uf09a010c"><span class="ne-text" style="font-size: 19px">2.6 关防火墙、开ssh</span></summary><p id="u12a87b1c" class="ne-p"><span class="ne-text" style="font-size: 19px">1、关闭防火墙</span></p><p id="u071a3fa1" class="ne-p"><span class="ne-text" style="font-size: 19px">systemctl disable firewalld --now #开机不自启并现在关闭防火墙</span></p><p id="u37a3926e" class="ne-p"><span class="ne-text" style="font-size: 19px"></span></p><p id="uea2793c0" class="ne-p"><span class="ne-text" style="font-size: 19px">2、开启ssh服务</span></p><p id="u4b8e234c" class="ne-p"><span class="ne-text" style="font-size: 19px">vi /etc/ssh/sshd_config #允许ssh</span></p><p id="u1404e09d" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1710913557263-a70e1584-0c5f-4064-bd18-7667becc1e4f.png" width="849.6296896496307" id="AoW2o" class="ne-image"></p><p id="u0e4afe98" class="ne-p"><span class="ne-text" style="font-size: 19px">systemctl restart sshd #重启ssh服务</span></p></details>
<details class="lake-collapse"><summary id="u4fafebed"><span class="ne-text" style="font-size: 19px">2.7 Ubuntu ssh登录Server2</span></summary><p id="u160e27b4" class="ne-p"><span class="ne-text" style="font-size: 19px">ssh root@10.4.220.100  #输入用户名密码，远程软件用Ubuntu自带终端或remmina都可以</span></p></details>
## 3小题
<details class="lake-collapse"><summary id="u88f30030"><span class="ne-text" style="font-size: 19px">3.1 Ubuntu传输镜像到Server2</span></summary><p id="u1d48fc97" class="ne-p"><span class="ne-text" style="font-size: 19px">scp + 镜像名 + root@10.4.220.100:/opt  #在Ubuntu传输镜像到Server2的opt目录下</span></p></details>
<details class="lake-collapse"><summary id="u396ee2c3"><span class="ne-text" style="font-size: 19px">3.2 搭建本地yum源</span></summary><p id="ua78b57c6" class="ne-p"><span class="ne-text" style="color: #DF2A3F; font-size: 19px">Server2执行以下操作</span></p><p id="u4eb42eb7" class="ne-p"><span class="ne-text" style="font-size: 19px">cd /etc/yum.repos.d/ #切换到yum文件所在目录</span></p><p id="u1a3fc158" class="ne-p"><span class="ne-text" style="font-size: 19px">vi rocky-devel.repo  #编辑yum文件，修改红框处</span></p><p id="u2f49aaff" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1710914769705-43f3f0b0-8af3-4259-bba0-ddff77cb1129.png" width="1171.6666201088183" id="Id96p" class="ne-image"></p><p id="u58b715d0" class="ne-p"><span class="ne-text" style="font-size: 19px">rm -rf 文件名 #删除除</span><span class="ne-text" style="font-size: 19px">rocky-devel.repo外的所有文件</span></p><p id="u15cae818" class="ne-p"><span class="ne-text" style="font-size: 19px">yum clean all #清除缓存</span></p><p id="u4aadd69e" class="ne-p"><span class="ne-text" style="font-size: 19px">yum makecache #建立新的仓库缓存</span></p><p id="u715135ea" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1710914261520-3b9ddbf1-3a04-42ea-b089-9fe91d353d3b.png" width="1344.1666132542844" id="yVMmN" class="ne-image"></p></details>
<details class="lake-collapse"><summary id="uf6964ff9"><span class="ne-text" style="font-size: 19px">3.3 安装软件</span></summary><p id="ue30de4db" class="ne-p"><span class="ne-text" style="font-size: 19px">yum install qemu* virt-*  libvirt* bash-comp* httpd -y </span></p><p id="ucb2fdc54" class="ne-p"><span class="ne-text" style="color: rgb(77, 77, 77); font-size: 19px">bash #重新加载，使tab功能生效</span></p></details>
<details class="lake-collapse"><summary id="u4067c293"><span class="ne-text" style="font-size: 19px">3.4 搭建网络yum源环境</span></summary><p id="ucc2e6146" class="ne-p"><span class="ne-text" style="font-size: 19px">mkdir /var/ww/html/a</span></p><p id="u09a403dc" class="ne-p"><span class="ne-text" style="font-size: 19px">umount /mnt</span></p><p id="ub3fb835f" class="ne-p"><span class="ne-text" style="font-size: 19px">mount /opt/镜像名  /var/www/html/a #挂载镜像到a目录</span></p><p id="ud79ec312" class="ne-p"><span class="ne-text" style="font-size: 19px">systemctl restart httpd</span></p></details>
<details class="lake-collapse"><summary id="ub6c6ea22"><span class="ne-text" style="font-size: 19px">包说明</span></summary><p id="uc9fee771" class="ne-p"><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">qemu-kvm：qemu模拟器</span><span class="ne-text" style="font-size: 19px"><br /></span><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">qemu-img：qemu磁盘image管理器</span><span class="ne-text" style="font-size: 19px"><br /></span><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">virt-install：用来创建虚拟机的命令行工具</span><span class="ne-text" style="font-size: 19px"><br /></span><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">libvirt：提供libvirtd daemon来管理虚拟机和控制hypervisor</span><span class="ne-text" style="font-size: 19px"><br /></span><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">libvirt-client：提供客户端API用来访问server和提供管理虚拟机命令行工具的virsh实体</span><span class="ne-text" style="font-size: 19px"><br /></span><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">virt-viewer：图形控制台，vnc的显示就是它提供</span></p><p id="u7c17c238" class="ne-p"><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">bash-completion：tab功能的软件包，可以进行命令补齐，减少配置难度</span></p><p id="u105d6226" class="ne-p"><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">httpd：为搭建yum源提供共享服务</span></p></details>
<details class="lake-collapse"><summary id="ue82f1f9b"><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">3.5 启动守护进程</span></summary><p id="ud1f387b8" class="ne-p"><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">systemctl enable libvirtd  --now #设为开机自启并现在启动</span></p><p id="u468e507e" class="ne-p"><span class="ne-text" style="color: rgb(18, 18, 18); font-size: 19px">systemctl status libvirtd              #查看运行状态</span></p></details>
## 4小题
### 4.1 小题
<details class="lake-collapse"><summary id="ua01f95a9"><span class="ne-text" style="font-size: 19px">4.1.1 创建Linux0</span></summary><p id="ud31ef13a" class="ne-p"><span class="ne-text" style="font-size: 19px">virt-install --name linux0 --memory 4096 --disk path=/var/lib/libvirt/images/linux0.qcow2,size=40,bus=virtio --vcpus 2 --os-variant auto --network bridge=br0</span><span class="ne-text" style="color: #DF2A3F; font-size: 19px">,model=virtio</span><span class="ne-text" style="font-size: 19px"> --cdrom /opt/Rocky-9.2-x86_64-dvd.iso --graphics vnc,listen=0.0.0.0 </span><span class="ne-text" style="color: #DF2A3F; font-size: 19px">--video virtio</span></p></details>
<details class="lake-collapse"><summary id="u4713fb19"><span class="ne-text" style="font-size: 19px">字段释义：</span></summary><p id="u3c59e563" class="ne-p"><span class="ne-text" style="font-size: 16px">1、--name linux1 #设置虚拟机名称</span></p><p id="ua0691267" class="ne-p"><span class="ne-text" style="font-size: 16px">2、--ram 2048  #分配内存大小，单位MB</span></p><p id="ud1bdd80a" class="ne-p"><span class="ne-text" style="font-size: 16px">3、--disk path=/var/lib/libvirt/images/linux1.qcow2,size=40,bus=virtio #指定硬盘文件路径 容量大小 类型 默认存放位置：/var/lib/libvirt/images</span></p><p id="u8e3861e4" class="ne-p"><span class="ne-text" style="font-size: 16px">4、--vcpus 2 #设置虚拟CPU数</span></p><p id="ue1e6e3f8" class="ne-p"><span class="ne-text" style="font-size: 16px">5、--os-variant rocky9 #指定操作系统类型</span></p><p id="uaeffbb9e" class="ne-p"><span class="ne-text" style="font-size: 16px">6、--network bridge=br0,model=virtio #网络模式 指定桥接网卡 类型</span></p><p id="u073b9fdb" class="ne-p"><span class="ne-text" style="font-size: 16px">7、--location /opt/Rocky-9.1-x86_64-dvd.iso #选择安装镜像的本地路径</span></p><p id="u342dc2b5" class="ne-p"><span class="ne-text" style="font-size: 16px">8、--graphics vnc,listen=0.0.0.0 #图形化输出为vnc，监听的IP地址为所有</span></p><p id="ud8e98d80" class="ne-p"><span class="ne-text" style="font-size: 16px">9、--video virtio #指定显示驱动</span></p></details>
<details class="lake-collapse"><summary id="u62307064"><span class="ne-text" style="font-size: 19px">4.1.2 VNC连接完成安装</span></summary><p id="ucdd1f730" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1716452174664-86c826a8-5470-4ec1-8861-d84afa74a713.png" width="470.22222222222223" id="u176c08b2" class="ne-image"></p><p id="ubabbd3bd" class="ne-p"><span class="ne-text">由于linux0是唯一1台启动的虚拟机，所以端口是5900</span></p><p id="u23833212" class="ne-p"><span class="ne-text">回车后跳出rocky安装界面，这里不做说明，正常进行设置完成安装即可</span></p></details>
<details class="lake-collapse"><summary id="uf01d8ce7"><span class="ne-text" style="font-size: 19px">注：关于VNC服务</span></summary><p id="uf16a898a" class="ne-p"><span class="ne-text" style="font-size: 16px">vnc默认端口为5900，如果有3台虚拟机，服务器IP为10.1.220.100:5900，那么登录vnc时，第一台为10.1.220.100，第二台为10.1.220.100:5901，第三台为10.1.220.100:5902，以此类推，若不关闭防火墙，需要放行相应服务或端口</span></p></details>
<details class="lake-collapse"><summary id="u6968c9e4"><span class="ne-text" style="font-size: 19px">4.1.3 进行Linux的基础配置</span></summary><ul class="ne-ul"><li id="ua591815c" data-lake-index-type="0"><span class="ne-text" style="color: #DF2A3F; font-size: 19px">修改IP地址</span></li></ul><p id="u88e3d7f2" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1716453081721-0f552ec7-f57b-4f88-bdda-dbedc88181a0.png" width="1311.111111111111" id="u72ba4af7" class="ne-image"></p><p id="ufb58b754" class="ne-p"><span class="ne-text">linux0为模版，为了节省linux1-9的配置量，dns可预先设置，IP地址设为10，后续linux1-9只需要在0后+1个数字</span></p><ul class="ne-ul"><li id="udb7c0ecb" data-lake-index-type="0"><span class="ne-text" style="color: #DF2A3F; font-size: 19px">关闭selinux</span></li></ul><p id="ua2bbe563" class="ne-p"><span class="ne-text">vi /etc/selinux/config</span></p><p id="u3286a535" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1716452320781-c2c75c15-9f12-450d-8cd0-36da49539f4e.png" width="1015.1111111111111" id="u0c3c75db" class="ne-image"></p><ul class="ne-ul"><li id="u7667b98b" data-lake-index-type="0"><span class="ne-text" style="color: #DF2A3F; font-size: 19px">关闭防火墙</span></li></ul><p id="ud16b0660" class="ne-p"><span class="ne-text" style="font-size: 19px">systemctl disable firewalld --now</span></p><ul class="ne-ul"><li id="uf94199df" data-lake-index-type="0"><span class="ne-text" style="color: #DF2A3F; font-size: 19px">允许ssh</span></li></ul><p id="u2ead26d0" class="ne-p"><span class="ne-text" style="font-size: 19px">vi /etc/ssh/sshd_conf</span></p><p id="u82a701dd" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1716452883280-49b8fdfd-d96a-4c55-a457-bd7bc9fc6433.png" width="1040" id="u85428d27" class="ne-image"></p><p id="u20c0ecfd" class="ne-p"><span class="ne-text" style="font-size: 19px">systemctl restart sshd</span></p><ul class="ne-ul"><li id="u1b72ce27" data-lake-index-type="0"><span class="ne-text" style="color: #DF2A3F; font-size: 19px">配置局域网yum源</span></li></ul><p id="u4e17e1e2" class="ne-p"><span class="ne-text" style="font-size: 19px">cd /etc/yum.repos.d/ #切换到yum文件所在目录</span></p><p id="ud822c7c3" class="ne-p"><span class="ne-text" style="font-size: 19px">vi rocky-devel.repo  #编辑yum文件，修改红框处</span></p><p id="u7f9f6bc7" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1710914091631-9a030fc9-19b9-4345-8a0f-87f3d9553376.png" width="1149.9999543031074" id="awsk9" class="ne-image"></p><p id="u40ff3f58" class="ne-p"><span class="ne-text" style="font-size: 19px">rm -rf 文件名 		#删除除rocky-devel.repo外的所有文件</span></p><p id="u24d7e5ff" class="ne-p"><span class="ne-text" style="font-size: 19px">yum clean all 		#清除缓存</span></p><p id="ud3849ad6" class="ne-p"><span class="ne-text" style="font-size: 19px">yum makecache 	#建立新的仓库缓存</span></p><p id="u0f36d080" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1710914261520-3b9ddbf1-3a04-42ea-b089-9fe91d353d3b.png" width="1344.1666132542844" id="oiDW9" class="ne-image"></p><ul class="ne-ul"><li id="u2534ef6c" data-lake-index-type="0"><span class="ne-text" style="color: #DF2A3F; font-size: 19px">安装tab包和vim编辑器</span></li></ul><p id="u68b863c2" class="ne-p"><span class="ne-text" style="font-size: 19px">yum install bash-comp* vim -y</span></p></details>
### 4.2小题
<details class="lake-collapse"><summary id="u626e81c5"><span class="ne-text">创建快照</span></summary><p id="u86f1afc6" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh shutdown linux0 #关机虚拟机</span></p><p id="ua02a4a39" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh snapshot-create-as linux0 linux-snapshot #创建快照</span></p></details>
<details class="lake-collapse"><summary id="u9fa8a36f"><span class="ne-text" style="font-size: 19px">克隆</span></summary><p id="u6416173e" class="ne-p"><span class="ne-text" style="font-size: 19px">virt-clone --original linux0  --name linux1 --file /var/lib/libvirt/images/linux1.qcow2 --auto-clone</span></p></details>
按上面的命令，修改--name 和qcow2磁盘文件名，依次完成2-9的克隆

### <font style="color:#DF2A3F;">修改linux1-9基础配置（必须）</font>
<details class="lake-collapse"><summary id="u24a18d2a"><span class="ne-text">修改IP地址及主机名</span></summary><p id="u7a68b805" class="ne-p"><span class="ne-text">for i in {1..9} ;do virsh start linux$i ;done   #依次启动linux1-9</span></p><p id="u0e8e47cf" class="ne-p"><span class="ne-text">使用remmina依次修改主机名和IP地址</span></p><p id="u2d76b9f4" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2024/png/33622884/1716452731685-5331d143-7090-46c1-9b6f-baaa17ec511d.png" width="473" id="ue3d6b705" class="ne-image"></p><p id="u51fbb9aa" class="ne-p"><span class="ne-text">所有主机修改完IP地址和主机，直接重启，不要去手动重新激活网卡，浪费时间</span></p></details>


### 扩展命令参考
<details class="lake-collapse"><summary id="ue7d084ff"><span class="ne-text" style="font-size: 19px">扩展命令</span></summary><p id="u05d1ba16" class="ne-p"><span class="ne-text" style="font-size: 19px">1、列出所有虚拟机，虚拟机状态</span></p><p id="u8277257e" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh list --all  </span></p><p id="ue8e720f3" class="ne-p"><span class="ne-text" style="font-size: 19px"><br /></span><span class="ne-text" style="font-size: 19px">2、启动虚拟机</span></p><p id="u47a21cc2" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh start linux1<br /><br /></span><span class="ne-text" style="font-size: 19px">3、关闭虚拟机</span></p><p id="u2937b288" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh shutdown linux1<br /><br /></span><span class="ne-text" style="font-size: 19px">4、重启虚拟机</span></p><p id="ub0171004" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh reboot linux1<br /><br /></span><span class="ne-text" style="font-size: 19px">5、销毁虚拟机，相当拔掉虚拟机的电源</span></p><p id="uabdb34af" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh destroy linux1 <br /><br /></span><span class="ne-text" style="font-size: 19px">6、删除虚拟机</span></p><p id="uee269d4f" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh undefine linux1 --nvram    #nvram为取消域定义<br /><br /></span><span class="ne-text" style="font-size: 19px">7、修改虚拟机名称</span></p><p id="u54867cd3" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh domrename linux100 linux1<br /><br /></span><span class="ne-text" style="font-size: 19px">8、修改硬盘文件名称</span></p><p id="ub9fb3892" class="ne-p"><span class="ne-text" style="font-size: 19px">mv /var/lib/libvirt/images/linux100.qcow2  /var/lib/libvirt/images/linux1.qcow2<br /><br /></span><span class="ne-text" style="font-size: 19px">9、获取域的网络接口状态</span></p><p id="ua1ccb21c" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh domiflist linux1<br /><br /></span><span class="ne-text" style="font-size: 19px">10、恢复快照</span></p><p id="u9b948062" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh snapshot-revert linux1 linux-snapshot<br /><br /></span><span class="ne-text" style="font-size: 19px">11、删除快照</span></p><p id="ue8d3b018" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh snapshot-delete linux1 linux-snapshot<br /><br /></span><span class="ne-text" style="font-size: 19px">12、添加磁盘<br /></span><span class="ne-text" style="font-size: 19px">qemu-img create -f qcow2 /cp/a.qcow2 10G<br /></span></p><p id="uef7a3d93" class="ne-p"><span class="ne-text" style="font-size: 19px">13、查看磁盘信息</span></p><p id="u7da0cd43" class="ne-p"><span class="ne-text" style="font-size: 19px">qemu-img info /opt/a.qcow2<br /></span></p><p id="ucda9b81a" class="ne-p"><span class="ne-text" style="font-size: 19px">14、挂载磁盘</span></p><p id="u0f9b0a54" class="ne-p"><span class="ne-text" style="font-size: 19px">virsh attach-disk linux1 /cp/a.qcow2 vdb --persistent --subdriver=qcow2 </span></p><p id="u54d9fd07" class="ne-p"><span class="ne-text" style="font-size: 19px">#将该磁盘连接到linux1当中，在linux中显示为vdb，persistent为永久的意思，subdriver指定磁盘类型</span></p><p id="u401af433" class="ne-p"><span class="ne-text" style="font-size: 19px"></span></p><p id="u98b133fe" class="ne-p"><span class="ne-text" style="font-size: 19px">15、查看主机磁盘连接情况<br /></span><span class="ne-text" style="font-size: 19px">virsh domblklist linux1<br /><br /></span><span class="ne-text" style="font-size: 19px">fdisk -l 查看所有磁盘信息，这个时候就有一个vdb<br /><br /></span><span class="ne-text" style="font-size: 19px">16、分离磁盘<br /></span><span class="ne-text" style="font-size: 19px">virsh detach-disk linux1 /cp/a.qcow2</span></p></details>






> 更新: 2024-05-23 16:33:26  
> 原文: <https://www.yuque.com/gengmouren-1f9qn/whktvz/sfa1knwz7o1co6z9>