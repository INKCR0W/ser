---
sidebar_position: 6
---

## **题目：**
任务描述：请采用 IIS 搭建 web 服务，创建安全动态网站，。 <br />把 windows3 配置为 ASP 网站，网站仅支持 dotnet clr v4.0，站点名称为 asp。 <br />http 和 https 绑定本机与外部通信的 IP 地址，仅允许使用域名访问 （使用“计算机副本”证书模板）。客户端访问时，必需有 ssl 证书 （浏览器证书模板为“管理员”）。 <br />网 站 目 录 为 C:\iis\contents ， 默 认 文 档 index.aspx 内 容 为 "HelloAspx"。 <br />使用 windows5 测试。
## 配置步骤：
### web服务安装
注意勾选角色服务里的asp和asp.net 4.8<br />![image.png](https://cdn.nlark.com/yuque/0/2024/png/33622884/1714272895324-235e16fd-48ec-4d0f-b0a9-f15542b60d54.png#averageHue=%23f7f7f6&clientId=u802069df-955c-4&from=paste&height=693&id=u42a28f62&originHeight=693&originWidth=965&originalType=binary&ratio=1&rotation=0&showTitle=false&size=190401&status=done&style=none&taskId=uba4e8a59-3757-4307-9578-931ff0dcdcb&title=&width=965)
### 网站配置
右击新建网站，创建对应目录<br />![image.png](https://cdn.nlark.com/yuque/0/2024/png/33622884/1714273294337-eb5c7227-6bf8-4f57-a0fc-3617b29e14fd.png#averageHue=%23f3f3f3&clientId=u802069df-955c-4&from=paste&height=813&id=u250c0308&originHeight=813&originWidth=1278&originalType=binary&ratio=1&rotation=0&showTitle=false&size=130251&status=done&style=none&taskId=ued866bbf-f64e-4c76-97d2-895511299a2&title=&width=1278)<br />导入windows1提供的skills证书<br />![image.png](https://cdn.nlark.com/yuque/0/2024/png/33622884/1714274165657-7a2051b1-1b36-4e8b-8f1f-c98aebf06b1c.png#averageHue=%23faf9f9&clientId=u68b31883-7a97-4&from=paste&height=728&id=u4dc9f31a&originHeight=728&originWidth=1918&originalType=binary&ratio=1&rotation=0&showTitle=false&size=180419&status=done&style=none&taskId=uce708be2-7116-459d-822c-003e6c2503b&title=&width=1918)右击asp网站，选择编辑绑定添加https绑定<br />![image.png](https://cdn.nlark.com/yuque/0/2024/png/33622884/1714273994164-706a6ce2-e32c-4f13-84fc-421f24ba7e40.png#averageHue=%23f4f4f4&clientId=u68b31883-7a97-4&from=paste&height=683&id=u51f5fcaa&originHeight=683&originWidth=1714&originalType=binary&ratio=1&rotation=0&showTitle=false&size=144362&status=done&style=none&taskId=uceeb8195-1c0b-4c04-bd30-d8f986115f4&title=&width=1714)<br />更改asp网站的应用池为经典dotnet clr v4.0<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/33622884/1698241425514-7ede6f86-dcb1-45f1-8f78-2010bb140079.png#averageHue=%23f7f5f4&clientId=ue528cb3b-274c-4&from=paste&height=306&id=ucc4655e0&originHeight=344&originWidth=1367&originalType=binary&ratio=1.125&rotation=0&showTitle=false&size=153094&status=done&style=none&taskId=uaed8f15c-1fa4-44eb-acb1-800ab9c08b8&title=&width=1215.111111111111)<br />全局处启用ASP父路径<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/33622884/1698241354067-f9f66142-67d4-45a8-8ffd-f2e298359d96.png#averageHue=%23f7f7f6&clientId=ue528cb3b-274c-4&from=paste&height=452&id=u4969dbb7&originHeight=508&originWidth=1341&originalType=binary&ratio=1.125&rotation=0&showTitle=false&size=100881&status=done&style=none&taskId=ud0c47643-e09e-485e-a9b7-434f3a0a97d&title=&width=1192)<br />添加MIME类型，使其支持aspx格式的文件<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/33622884/1698242066273-4482f19d-2626-4c10-b58a-97fafbe100d1.png#averageHue=%23f7f6f5&clientId=ue528cb3b-274c-4&from=paste&height=530&id=u6f163a04&originHeight=596&originWidth=1229&originalType=binary&ratio=1.125&rotation=0&showTitle=false&size=183151&status=done&style=none&taskId=u3ec9d9fd-21bd-4f52-b4c7-3a0bc3d4e0e&title=&width=1092.4444444444443)<br />手动在网站目录下新建index.aspx并添加内容HelloAspx，然后如下图添加默认文档<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/33622884/1698242315028-f1aaac82-f01c-4fad-bdbd-2eb4ec2704c3.png#averageHue=%23faf9f8&clientId=ue528cb3b-274c-4&from=paste&height=434&id=u49c77427&originHeight=488&originWidth=1036&originalType=binary&ratio=1.125&rotation=0&showTitle=false&size=118038&status=done&style=none&taskId=ued4bcf5c-ea0c-43ef-907c-1cb7a98e5fe&title=&width=920.8888888888889)
### 测试
windows5申请管理员证书，公用名Windows3.skills.lan，dns为Windows3.skills.lan<br />![image.png](https://cdn.nlark.com/yuque/0/2024/png/33622884/1714221675124-61d831f7-176b-4014-9ab7-41bf53edf0f7.png#averageHue=%23faf9f8&clientId=u3c9afd38-d2fc-4&from=paste&height=604&id=u1bfd0220&originHeight=604&originWidth=1076&originalType=binary&ratio=1&rotation=0&showTitle=false&size=130233&status=done&style=none&taskId=u6fabe80e-156c-4a22-8afd-fb2764a4c20&title=&width=1076)<br />使用IE浏览器访问<br />![image.png](https://cdn.nlark.com/yuque/0/2024/png/33622884/1714273579285-b4598875-404a-4c60-ab7a-123f39847549.png#averageHue=%23f2f2f2&clientId=u802069df-955c-4&from=paste&height=585&id=u77215179&originHeight=585&originWidth=1174&originalType=binary&ratio=1&rotation=0&showTitle=false&size=36395&status=done&style=none&taskId=u9a30da11-b841-484f-848f-883bfe06a93&title=&width=1174)<br />域名正常访问，IP无法访问<br />![image.png](https://cdn.nlark.com/yuque/0/2024/png/33622884/1714273714350-1c3a821b-8b46-41af-811e-a8c2cd25242a.png#averageHue=%23f3f2f2&clientId=u802069df-955c-4&from=paste&height=587&id=u895610b0&originHeight=587&originWidth=1515&originalType=binary&ratio=1&rotation=0&showTitle=false&size=64403&status=done&style=none&taskId=u723cee68-522e-411f-b9a1-b490d358cbb&title=&width=1515)
