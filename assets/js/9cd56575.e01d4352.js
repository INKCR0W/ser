"use strict";(self.webpackChunkser=self.webpackChunkser||[]).push([[1049],{856:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>o});var t=i(4848),s=i(8453);const a={sidebar_position:12},l=void 0,r={id:"\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/12\u3001podman\u670d\u52a1x86 \u221a",title:"12\u3001podman\u670d\u52a1x86 \u221a",description:"\u9898\u76ee\uff1a",source:"@site/docs/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/12\u3001podman\u670d\u52a1x86 \u221a.md",sourceDirName:"\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e",slug:"/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/12\u3001podman\u670d\u52a1x86 \u221a",permalink:"/docs/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/12\u3001podman\u670d\u52a1x86 \u221a",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:12,frontMatter:{sidebar_position:12},sidebar:"tutorialSidebar",previous:{title:"11\u3001mysql\u670d\u52a1 \u221a",permalink:"/docs/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/11\u3001mysql\u670d\u52a1 \u221a"},next:{title:"13\u3001podman\u670d\u52a1-arm \u221a",permalink:"/docs/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/13\u3001podman\u670d\u52a1-arm \u221a"}},d={},o=[{value:"<strong>\u9898\u76ee\uff1a</strong>",id:"\u9898\u76ee",level:2},{value:"\u914d\u7f6e\u6b65\u9aa4\uff1a",id:"\u914d\u7f6e\u6b65\u9aa4",level:2},{value:"1\u5c0f\u9898",id:"1\u5c0f\u9898",level:2},{value:"1.1 \u5b89\u88c5podman",id:"11-\u5b89\u88c5podman",level:3},{value:"1.2 \u5bfc\u5165\u955c\u50cf",id:"12-\u5bfc\u5165\u955c\u50cf",level:3},{value:"1.3 \u521b\u5efa\u5bb9\u5668",id:"13-\u521b\u5efa\u5bb9\u5668",level:3},{value:"1.4 \u8fdb\u5165\u5bb9\u5668\uff0c\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e",id:"14-\u8fdb\u5165\u5bb9\u5668\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e",level:3},{value:"1.5 \u5728\u5bb9\u5668\u4e2d\u5b89\u88c5httpd\uff0c\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e",id:"15-\u5728\u5bb9\u5668\u4e2d\u5b89\u88c5httpd\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e",level:3},{value:"2\u5c0f\u9898",id:"2\u5c0f\u9898",level:2},{value:"2.1 \u914d\u7f6e\u79c1\u6709\u4ed3\u5e93",id:"21-\u914d\u7f6e\u79c1\u6709\u4ed3\u5e93",level:3},{value:"2.2 \u5bfc\u5165registry\u955c\u50cf",id:"22-\u5bfc\u5165registry\u955c\u50cf",level:3}];function c(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"\u9898\u76ee",children:(0,t.jsx)(e.strong,{children:"\u9898\u76ee\uff1a"})}),"\n",(0,t.jsx)(e.p,{children:"\u8bf7\u91c7\u7528 podman\uff0c\u5b9e\u73b0\u5bb9\u5668\u865a\u62df\u5316\u6280\u672f\u3002\n1\u3001\u5728 linux3 \u4e0a\u5b89\u88c5 podman\uff0c\u5bfc\u5165 rockylinux-9.tar \u955c\u50cf\u3002 \u521b\u5efa\u540d\u79f0\u4e3a skills \u7684\u5bb9\u5668\uff0c\u6620\u5c04\u672c\u673a\u7684 8000 \u7aef\u53e3\u5230\u5bb9\u5668\u7684 80 \u7aef\u53e3\uff0c \u5728\u5bb9\u5668\u5185\u5b89\u88c5 httpd\uff0c\u9ed8\u8ba4\u7f51\u9875\u5185\u5bb9\u4e3a\u201cHelloPodman\u201d\u3002\n2\u3001\u914d\u7f6e https \u8bbf\u95ee\u7684\u79c1\u6709\u4ed3\u5e93\uff0c\u767b\u5f55\u7528\u6237\u548c\u5bc6\u7801\u5747\u4e3a admin\u3002\u5bfc\u5165registry.tar \u955c\u50cf\uff0c\u521b\u5efa\u540d\u79f0\u4e3a registry \u7684\u5bb9\u5668\u3002\n3\u3001\u4fee \u6539 rockylinux \u955c\u50cf\u7684tag\u4e3alinux3.skills.lan:5000/rockylinux:9\uff0c\u4e0a\u4f20\u8be5\u955c\u50cf\u5230\u79c1\u6709\u4ed3\u5e93\u3002\n\u6269\u5c55\npodman exec -it skills bash"}),"\n",(0,t.jsx)(e.h2,{id:"\u914d\u7f6e\u6b65\u9aa4",children:"\u914d\u7f6e\u6b65\u9aa4\uff1a"}),"\n",(0,t.jsx)(e.h2,{id:"1\u5c0f\u9898",children:"1\u5c0f\u9898"}),"\n",(0,t.jsx)(e.h3,{id:"11-\u5b89\u88c5podman",children:"1.1 \u5b89\u88c5podman"}),"\n",(0,t.jsx)(e.p,{children:"yum install podman* -y\nsystemctl enable --now podman"}),"\n",(0,t.jsx)(e.h3,{id:"12-\u5bfc\u5165\u955c\u50cf",children:"1.2 \u5bfc\u5165\u955c\u50cf"}),"\n",(0,t.jsxs)(e.p,{children:["podman load -i rockylinux-9.tar\npodman images  #\u67e5\u770b\u5bfc\u5165\u7684\u955c\u50cf\u4fe1\u606f\n",(0,t.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2024/png/33622884/1706090679574-18dfe548-3992-4aee-9f9a-92f29b52ba03.png#averageHue=%23320c26&clientId=u0c7e01e1-0e05-4&from=paste&height=80&id=vkvyA&originHeight=80&originWidth=736&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26386&status=done&style=none&taskId=u7353ca89-cf49-47c0-ac9c-eb1d128d100&title=&width=736",alt:"image.png"})]}),"\n",(0,t.jsx)(e.h3,{id:"13-\u521b\u5efa\u5bb9\u5668",children:"1.3 \u521b\u5efa\u5bb9\u5668"}),"\n",(0,t.jsx)(e.p,{children:"podman run -itd -p 8000:80 --name skills 210996f98b85 /usr/sbin/init\n\u6ce8\u610f\uff01\u5fc5\u987b\u52a0/usr/sbin/init \u5426\u5219\u5bb9\u5668\u5185\u7684systemctl\u7528\u4e0d\u4e86"}),"\n",(0,t.jsx)(e.h3,{id:"14-\u8fdb\u5165\u5bb9\u5668\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e",children:"1.4 \u8fdb\u5165\u5bb9\u5668\uff0c\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e"}),"\n",(0,t.jsx)(e.p,{children:"podman exec -it skills bash"}),"\n",(0,t.jsxs)(e.p,{children:["\u914d\u7f6ehttp\u7f51\u7edc\u6e90\n",(0,t.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2024/png/33622884/1706090538417-fd36d7c5-07fb-474e-82b1-7d469399fbd7.png#averageHue=%23310b25&clientId=u0c7e01e1-0e05-4&from=paste&height=242&id=u59562248&originHeight=242&originWidth=568&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33901&status=done&style=none&taskId=ub4553832-57ae-4e19-b5c9-2f2e54c3f38&title=&width=568",alt:"image.png"}),"\nyum clean all\nyum makecache"]}),"\n",(0,t.jsx)(e.h3,{id:"15-\u5728\u5bb9\u5668\u4e2d\u5b89\u88c5httpd\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e",children:"1.5 \u5728\u5bb9\u5668\u4e2d\u5b89\u88c5httpd\uff0c\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e"}),"\n",(0,t.jsx)(e.p,{children:'yum install httpd\necho "Helledocker" > /var/www/html/index.html\nhttpd -k start\ncurl localhost'}),"\n",(0,t.jsx)(e.h2,{id:"2\u5c0f\u9898",children:"2\u5c0f\u9898"}),"\n",(0,t.jsx)(e.h3,{id:"21-\u914d\u7f6e\u79c1\u6709\u4ed3\u5e93",children:"2.1 \u914d\u7f6e\u79c1\u6709\u4ed3\u5e93"}),"\n",(0,t.jsx)(e.p,{children:'vim /etc/containers/registries.conf\nprefix = "linux3.skills.lan:5000"  #\u6307\u5b9a\u955c\u50cf\u524d\u7f00\nlocation = "linux.skills.lan:5000" #\u6307\u5b9a\u83b7\u53d6\u5730\u5740\ninsecure = true #\u5141\u8bb8\u901a\u8fc7http\u534f\u8bae\u83b7\u53d6\u955c\u50cf'}),"\n",(0,t.jsx)(e.p,{children:"systemctl daemon-reload    #\u91cd\u65b0\u52a0\u8f7d\u6240\u6709 systemd \u5b88\u62a4\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\nsystemctl restart podman    #\u91cd\u542f\u542f\u52a8podman\uff0c\u79c1\u6709\u4ed3\u5e93\u7684\u914d\u7f6e\u751f\u6548"}),"\n",(0,t.jsx)(e.h3,{id:"22-\u5bfc\u5165registry\u955c\u50cf",children:"2.2 \u5bfc\u5165registry\u955c\u50cf"}),"\n",(0,t.jsx)(e.p,{children:"podman load -i registry.tar"}),"\n",(0,t.jsxs)(e.p,{children:["mkdir /podman/admin -p    #\u767b\u5f55\u7528\u6237\u5bc6\u7801\u5b58\u653e\u70b9\nmkdir /podman/registry      #\u955c\u50cf\u5b58\u653e\u70b9\nmkdir /podman/cert\t     #\u8bc1\u4e66\u5b58\u653e\u70b9\nhtpasswd -Bc /podman/admin/htpasswd admin\t#\u8bbe\u7f6ehtpasswd\u8d26\u6237\u5bc6\u7801\ncat /etc/ssl/cacert.pem >> /etc/pki/tls/certs/ca-bundle.crt\n",(0,t.jsx)(e.img,{src:"https://cdn.nlark.com/yuque/0/2024/png/33622884/1706188454651-18a2c4b0-5e91-4667-b5d3-a6535f3e1479.png#averageHue=%23310b25&clientId=u64221790-2036-4&from=paste&height=107&id=u9ec7caab&originHeight=107&originWidth=747&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28754&status=done&style=none&taskId=ub3a5a635-fb09-4ae3-91d5-1237b63d496&title=&width=747",alt:"image.png"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'podman run -itd --name registry \\\n-p 5000:5000 \\      #\u5c06\u4e3b\u673a\u76845000\u7aef\u53e3\u6620\u5c04\u5230\u5bb9\u5668\u76845000\u7aef\u53e3\n-v /podman/registry/:/var/lib/registry:z \\ #\u5c06\u4e3b\u673a\u7684/podman/registry/\u6302\u8f7d\u5230\u5bb9\u5668\u7684/var/lib/registry\uff0c\u5e76\u542f\u7528\u6302\u8f7d\u7684\u6743\u9650\u68c0\u67e5\u3002\n-v /podman/admin/:/auth:z \\\t\t#\u5c06\u4e3b\u673a\u7684/podman/admin/\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684/auth\u76ee\u5f55\uff0c\u5e76\u542f\u7528\u6302\u8f7d\u7684\u6743\u9650\u68c0\u67e5\u3002\n-e "REGISTRY_AUTH=htpasswd" \\  #\u8bbe\u7f6e\u79c1\u6709\u4ed3\u5e93\u7684\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b\u4e3ahtpasswd\u3002\n-e "REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm" \\\t#\u8bbe\u7f6e\u79c1\u6709\u4ed3\u5e93\u7684\u8eab\u4efd\u9a8c\u8bc1\u57df\n-e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \\   #\u6307\u5b9ahtpasswd\u6587\u4ef6\u8def\u5f84\u3002\n-v /podman/cert/:/certs:z \\  #\u5c06\u4e3b\u673a\u7684/podman/cert/\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684/certs\u76ee\u5f55\uff0c\u5e76\u542f\u7528\u6302\u8f7d\u7684\u6743\u9650\u68c0\u67e5\u3002\n-e "REGISTRY_HTTP_TLS_CERTIFICATE=/certs/skills.crt" \\ #\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u6307\u5b9a\u8bc1\u4e66\u8def\u5f84\n-e "REGISTRY_HTTP_TLS_KEY=/certs/skills.key" \\ #\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u6307\u5b9a\u79c1\u94a5\u7684\u8def\u5f84\n-e REGISTRY_COMPATIBILITY_SCHEMA1_ENABLED=true \\ #\u542f\u7528\u517c\u5bb9\u6027\u6a21\u5f0f\uff0c\u652f\u6301\u65e7\u7248\u672c\u7684\u955c\u50cf\n-e REGISTRY_STORAGE_DELETE_ENABLED=true \\  #\u542f\u7528\u5220\u9664\u955c\u50cf\u529f\u80fd\uff0c\u5141\u8bb8\u5220\u9664\u955c\u50cf\nregistry\n'})}),"\n",(0,t.jsx)(e.p,{children:"podman tag 210996f98b85 linux3.skills.lan:5000/rockylinux:9  #\u4fee\u6539\u6807\u7b7e\npodman login -u admin -p admin linux3.skills.lan:5000            #\u767b\u5f55\u5230\u79c1\u6709\u4ed3\u5e93\npodman push --tls-verify=false linux3.skills.lan:5000/rockylinux:9 #\u4e0a\u4f20  rockylinux:9\u672c\u5730\u955c\u50cf\u5230linux3.skills.lan:5000\u4ed3\u5e93"}),"\n",(0,t.jsxs)(e.p,{children:['curl -k -u "admin',":admin",'" ',(0,t.jsx)(e.a,{href:"https://linux3.skills.lan:5000/v2/_catalog",children:"https://linux3.skills.lan:5000/v2/_catalog"})]}),"\n",(0,t.jsx)(e.p,{children:"podman exec -it registry /bin/sh\nls certs\nls auth\nls /var/lib/registry/v2/repos/rocky"})]})}function p(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>r});var t=i(6540);const s={},a=t.createContext(s);function l(n){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);