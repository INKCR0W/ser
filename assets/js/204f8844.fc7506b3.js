"use strict";(self.webpackChunkser=self.webpackChunkser||[]).push([[9271],{9558:(e,l,n)=>{n.r(l),n.d(l,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>d});var s=n(4848),t=n(8453);const i={sidebar_position:4},a=void 0,r={id:"\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/4\u3001Apache\u670d\u52a1 \u221a",title:"4\u3001Apache\u670d\u52a1 \u221a",description:"\u9898\u76ee\uff1a",source:"@site/docs/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/4\u3001Apache\u670d\u52a1 \u221a.md",sourceDirName:"\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e",slug:"/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/4\u3001Apache\u670d\u52a1 \u221a",permalink:"/docs/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/4\u3001Apache\u670d\u52a1 \u221a",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"3\u3001ansible\u670d\u52a1 \u221a",permalink:"/docs/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/3\u3001ansible\u670d\u52a1 \u221a"},next:{title:"5\u3001nginx\u548ctomcat\u670d\u52a1 \u221a",permalink:"/docs/\u4e8c\u3001\u670d\u52a1\u5668\u6a21\u5757/\u56db\u3001Linux\u4e91\u670d\u52a1\u914d\u7f6e/5\u3001nginx\u548ctomcat\u670d\u52a1 \u221a"}},c={},d=[{value:"** \u9898\u76ee\uff1a**",id:"-\u9898\u76ee",level:2},{value:"\u914d\u7f6e\u6b65\u9aa4\uff1a",id:"\u914d\u7f6e\u6b65\u9aa4",level:2},{value:"1\u5c0f\u9898",id:"1\u5c0f\u9898",level:2},{value:"1\u3001\u5b89\u88c5httpd\u670d\u52a1",id:"1\u5b89\u88c5httpd\u670d\u52a1",level:3},{value:"2\u3001\u4fee\u6539ssl.conf\u914d\u7f6e\u6587\u4ef6",id:"2\u4fee\u6539sslconf\u914d\u7f6e\u6587\u4ef6",level:3},{value:"3\u3001\u5199\u5165\u4e3b\u9875\u6587\u4ef6\u5185\u5bb9",id:"3\u5199\u5165\u4e3b\u9875\u6587\u4ef6\u5185\u5bb9",level:3},{value:"4\u3001\u4fee\u6539dns\u89e3\u6790\u6587\u4ef6",id:"4\u4fee\u6539dns\u89e3\u6790\u6587\u4ef6",level:3},{value:"2\u5c0f\u9898",id:"2\u5c0f\u9898",level:2},{value:"3\u5c0f\u9898",id:"3\u5c0f\u9898",level:2},{value:"\u6d4b\u8bd5",id:"\u6d4b\u8bd5",level:2}];function p(e){const l={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.h2,{id:"-\u9898\u76ee",children:"** \u9898\u76ee\uff1a**"}),"\n",(0,s.jsx)(l.p,{children:'1\u3001\u914d\u7f6e linux1 \u4e3a Apache2 \u670d\u52a1\u5668\uff0c\u4f7f\u7528 skills.lan \u6216 any.skills.lan \uff08any \u4ee3\u8868\u4efb\u610f\u7f51\u5740\u524d\u7f00\uff0c\u7528 linux1.skills.lan \u548c web.skills.lan \u6d4b\u8bd5\uff09\u8bbf\u95ee\u65f6\uff0c\u81ea\u52a8\u8df3\u8f6cwww.skills.lan\u3002\u7981\u6b62\u4f7f\u7528 IP \u5730\u5740\u8bbf\u95ee\uff0c \u9ed8\u8ba4\u9996\u9875\u6587\u6863/var/www/html/index.html \u7684\u5185\u5bb9\u4e3a"HelloApache"\u3002\n2\u3001\u628a/etc/pki/tls/skills.crt \u8bc1\u4e66\u6587\u4ef6\u548c/etc/pki/tls/skills.key \u79c1\u94a5\u6587\u4ef6\u8f6c\u6362\u6210\u542b\u6709\u8bc1\u4e66\u548c\u79c1\u94a5\u7684/etc/pki/tls/skills.pfx \u6587\u4ef6\uff1b \u7136\u540e\u628a /etc/pki/tls/skills.pfx \u8f6c \u6362 \u4e3a \u542b \u6709 \u8bc1 \u4e66 \u548c \u79c1 \u94a5 \u7684 /etc/pki/tls/skills.pem \u6587\u4ef6\uff0c\u518d\u4ece/etc/pki/tls/skills.pem \u6587 \u4ef6 \u4e2d \u63d0 \u53d6 \u8bc1 \u4e66 \u548c \u79c1 \u94a5 \u5206 \u522b \u5230 /etc/pki/tls/apache.crt \u548c /etc/pki/tls/apache.key\u3002\n3\u3001\u5ba2\u6237\u7aef\u8bbf\u95ee Apache \u670d\u52a1\u65f6\uff0c\u5fc5\u9700\u6709 ssl \u8bc1\u4e66\u3002'}),"\n",(0,s.jsx)(l.h2,{id:"\u914d\u7f6e\u6b65\u9aa4",children:"\u914d\u7f6e\u6b65\u9aa4\uff1a"}),"\n",(0,s.jsx)(l.h2,{id:"1\u5c0f\u9898",children:"1\u5c0f\u9898"}),"\n",(0,s.jsx)(l.h3,{id:"1\u5b89\u88c5httpd\u670d\u52a1",children:"1\u3001\u5b89\u88c5httpd\u670d\u52a1"}),"\n",(0,s.jsx)(l.p,{children:"yum install httpd mod_ssl -y    #mod_ssl\u4e3a2-3\u5c0f\u9898\u6240\u7528"}),"\n",(0,s.jsx)(l.h3,{id:"2\u4fee\u6539sslconf\u914d\u7f6e\u6587\u4ef6",children:"2\u3001\u4fee\u6539ssl.conf\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{children:"#http\u5c06\u6240\u6709\u8bbf\u95ee linux1.skills.lan \u6216 any.skills.lan \u7684\u8bf7\u6c42\u91cd\u5b9a\u5411\u5230 https://www.skills.lan\n<VirtualHost *:80>\nServerName linux1.skills.lan\nServerAlias any.skills.lan\nrewriteengine on\nrewriterule ^/(.*) https://www.skills.lan\n</VirtualHost>\n#https\u542f\u7528\u8bc1\u4e66\u5e76\u7ed1\u5b9a\n<VirtualHost *:443>\nServerName linux1.skills.lan\nSSLEngine on\nSSLCertificateFile /etc/ssl/skills.crt\nSSLcertificatekeyFile /etc/ssl/skills.key\n</VirtualHost>\n#http\u91cd\u5b9a\u5411\u5230403\u9519\u8bef\u9875\u9762\n<VirtualHost *:80>\nservername 10.4.220.101\nredirect 403 /\n</virtualHost>\n#https\u91cd\u5b9a\u5411\u5230403\u9519\u8bef\u9875\u9762\n<VirtualHost *:443>\nservername 10.4.220.101\nredirect 403\n</virtualHost>\n"})}),"\n",(0,s.jsx)(l.h3,{id:"3\u5199\u5165\u4e3b\u9875\u6587\u4ef6\u5185\u5bb9",children:"3\u3001\u5199\u5165\u4e3b\u9875\u6587\u4ef6\u5185\u5bb9"}),"\n",(0,s.jsx)(l.p,{children:"echo HelloApache >> /var/www/html/index.html \u5199\u5165\u5185\u5bb9"}),"\n",(0,s.jsx)(l.h3,{id:"4\u4fee\u6539dns\u89e3\u6790\u6587\u4ef6",children:"4\u3001\u4fee\u6539dns\u89e3\u6790\u6587\u4ef6"}),"\n",(0,s.jsx)(l.p,{children:"\u6b63\u5411\u533a\u57df\u6587\u4ef6\u4e2d\u52a0\u5165*\u4e0e10.4.220.101\u7684\u5bf9\u5e94\u8bb0\u5f55\uff0c\u53cd\u5411\u4e0d\u7528\u52a0"}),"\n",(0,s.jsxs)(l.ul,{children:["\n",(0,s.jsx)(l.li,{children:"A       10.4.220.101\nsystemctl restart named\n\u6ce8\u610f\uff1a\u5728hosts\u6587\u4ef6\u4e2d\u5199\u5bf9\u5e94\u5173\u7cfb\u53ea\u80fd\u5728\u672c\u673a\u6b63\u5e38\u6d4b\u8bd5"}),"\n"]}),"\n",(0,s.jsx)(l.h2,{id:"2\u5c0f\u9898",children:"2\u5c0f\u9898"}),"\n",(0,s.jsx)(l.p,{children:"key\u548ccrt \u8f6c\u4e3apfx\nopenssl pkcs12 -export -out skills.pfx -inkey skills.key -in skills.crt"}),"\n",(0,s.jsx)(l.p,{children:"pfx\u8f6c\u4e3apem\nopenssl pkcs12 -in skills.pfx -nodes -out skills.pem"}),"\n",(0,s.jsxs)(l.p,{children:["\u63d0\u53d6pem\u4e2d\u7684\u8bc1\u4e66\u4e3acrt\u548ckey",(0,s.jsx)(l.br,{}),"\n","openssl x509 -in skills.pem -out apache.crt",(0,s.jsx)(l.br,{}),"\n","openssl rsa -in skills.pem -out apache.key"]}),"\n",(0,s.jsx)(l.h2,{id:"3\u5c0f\u9898",children:"3\u5c0f\u9898"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{children:"SSLCertificateFile /etc/pki/tls/apache.crt\t\t #\u7ed1\u5b9assl\u8bc1\u4e66\nSSLCertificateKeyFile /etc/pki/tls/apache.key  #\u7ed1\u5b9assl\u8bc1\u4e66\u79c1\u94a5\nSSLCACertificateFile /etc/pki/tls/cacert.pem   #\u7ed1\u5b9aca\u8bc1\u4e66\nSSLVerifyClient require    #\u5ba2\u6237\u7aef\u5fc5\u987b\u63d0\u4f9b\u6709\u6548\u7684\u8bc1\u4e66\u624d\u80fd\u4e0e\u670d\u52a1\u5668\u8fdb\u884cSSL\u8fde\u63a5\nSSLVerifyDepth  10\t\t\t\t #\u8bbe\u7f6e\u4e3a10\u8868\u793a\u5728\u9a8c\u8bc1\u8bc1\u4e66\u94fe\u65f6\uff0c\u6700\u591a\u53ef\u4ee5\u904d\u5386\u523010\u5c42\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u6df1\u5ea6\u5c06\u62d2\u7edd\u8fde\u63a5\u3002\n"})}),"\n",(0,s.jsx)(l.p,{children:"systemctl restart httpd"}),"\n",(0,s.jsx)(l.h2,{id:"\u6d4b\u8bd5",children:"\u6d4b\u8bd5"}),"\n",(0,s.jsxs)(l.p,{children:["cd /etc/pki/tls  #\u5207\u6362\u81f3\u8bc1\u4e66\u6240\u5728\u76ee\u5f55\n\u8df3\u8f6c\u6d4b\u8bd5\ncurl ",(0,s.jsx)(l.a,{href:"http://linux1.skills.lan",children:"http://linux1.skills.lan"}),"\ncurl ",(0,s.jsx)(l.a,{href:"http://100.skills.lan",children:"http://web.skills.lan"}),"\ncurl ",(0,s.jsx)(l.a,{href:"http://100.skills.lan",children:"http://100.skills.lan"}),"\n",(0,s.jsx)(l.img,{src:"https://cdn.nlark.com/yuque/0/2024/png/33622884/1714053274741-2e4cda88-9bba-4626-9309-29761410fa28.png#averageHue=%23090706&clientId=u52aa31ee-ffc9-4&from=paste&height=652&id=ud104beaa&originHeight=734&originWidth=1183&originalType=binary&ratio=1.125&rotation=0&showTitle=false&size=79289&status=done&style=none&taskId=u673be210-d25f-4ffc-b984-6019f87bb88&title=&width=1051.5555555555557",alt:"image.png"}),"\n\u5fc5\u9700\u8bc1\u4e66\u6d4b\u8bd5\ncurl ",(0,s.jsx)(l.a,{href:"https://www.skills.lan",children:"https://www.skills.lan"}),"\n",(0,s.jsx)(l.img,{src:"https://cdn.nlark.com/yuque/0/2024/png/33622884/1714053398579-671d22ac-7492-4942-857c-4728f7c33714.png#averageHue=%23120f0d&clientId=u52aa31ee-ffc9-4&from=paste&height=62&id=uc315795f&originHeight=70&originWidth=1187&originalType=binary&ratio=1.125&rotation=0&showTitle=false&size=14434&status=done&style=none&taskId=uc9a25b17-8ff0-4b59-b493-f914ae27b05&title=&width=1055.111111111111",alt:"image.png"}),"\n\u5fc5\u9700\u8bc1\u4e66\u6d4b\u8bd5\ncurl ",(0,s.jsx)(l.a,{href:"https://www.skills.lan",children:"https://www.skills.lan"})," --cert skills.pem\ncurl ",(0,s.jsx)(l.a,{href:"https://www.skills.lan",children:"https://www.skills.lan"})," --cert skills.crt --key skills.key\ncurl ",(0,s.jsx)(l.a,{href:"https://www.skills.lan",children:"https://www.skills.lan"})," --cert apache.crt --key apache.key\n",(0,s.jsx)(l.img,{src:"https://cdn.nlark.com/yuque/0/2024/png/33622884/1714053501155-d19272df-6dc6-4c55-b576-561e17d9e44e.png#averageHue=%230e0c0a&clientId=u52aa31ee-ffc9-4&from=paste&height=164&id=u4c5a1f8a&originHeight=184&originWidth=1187&originalType=binary&ratio=1.125&rotation=0&showTitle=false&size=30295&status=done&style=none&taskId=ue75503ca-f82a-4b94-8d9d-662130918c9&title=&width=1055.111111111111",alt:"image.png"})]})]})}function h(e={}){const{wrapper:l}={...(0,t.R)(),...e.components};return l?(0,s.jsx)(l,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453:(e,l,n)=>{n.d(l,{R:()=>a,x:()=>r});var s=n(6540);const t={},i=s.createContext(t);function a(e){const l=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(l):{...l,...e}}),[l,e])}function r(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(i.Provider,{value:l},e.children)}}}]);